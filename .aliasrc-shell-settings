#!/bin/bash
# vi: ft=zsh

alias gs="git status"
alias usingport=__usingport

__usingport() {
  port=`echo "$@" | egrep -o "\d+"`
  dokill=`echo "$@" | egrep -o "\-k"`

  results=`lsof -i -n -P | grep TCP | egrep ":$port \(LISTEN\)"`
  echo "$results" | egrep ":$port"

  pids=`echo $results | awk '{print $2}' ORS=' '`

  if [ ! -z $dokill ]; then
    echo $pids | xargs kill -9
  else
    if [ -z $results ]; then
      len=${#results}
      if [ $len -gt 1 ]; then
        echo "\n> pass -k to kill all matching processes"
      fi
    fi
  fi
}

