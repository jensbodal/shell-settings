repos:
  - repo: local
    hooks:
      - id: trufflehog
        name: trufflehog (local)
        language: system          # pre-commit won’t try to pip-install
        entry: pkgx               # ↳ pkgx handles binaries & caching
        args:
          - trufflehog@3.89.1     # pin CLI release
          - git
          - file://.
          - --since-commit        # scan only what you’re adding
          - HEAD
          - --only-verified       # cut false-positives
          - --fail                # non-zero exit on leak
          - --exclude-paths
          - trufflehog-exclude-paths.txt
        pass_filenames: false     # let the args decide scope
        stages: [pre-push]

  - repo: local
    hooks:
      - id: gitleaks
        name: gitleaks (local)
        language: system
        entry: pkgx
        args:
          - gitleaks
          - detect
          - --source=.
          - --verbose
        pass_filenames: false     # let gitleaks handle file discovery
        stages: [pre-commit,pre-push]
