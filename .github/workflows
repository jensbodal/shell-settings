name: secret-scan
on:
  push:
    branches: [main]
  pull_request:
permissions:
  contents: read        # least-privilege
jobs:
  trufflehog:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - name: TruffleHog OSS
        uses: trufflesecurity/trufflehog@v3.89.1   # official action  [oai_citation:0‡github.com](https://github.com/marketplace/actions/trufflehog-oss?utm_source=chatgpt.com)
        with:
          scanMode: filesystem                     # scan the checked-out code  [oai_citation:1‡trufflesecurity.com](https://trufflesecurity.com/blog/running-trufflehog-in-a-github-action?utm_source=chatgpt.com)
          extraArgs: --no-verification --only-verified
          exitCode: true      
